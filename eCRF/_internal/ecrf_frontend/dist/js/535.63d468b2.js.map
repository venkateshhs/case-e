{"version":3,"file":"js/535.63d468b2.js","mappings":"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","sources":["webpack://ecrf_frontend/./node_modules/core-js/modules/es.iterator.flat-map.js","webpack://ecrf_frontend/./src/components/StudyDataDashboard.vue","webpack://ecrf_frontend/./src/components/StudyDataDashboard.vue?2dcb","webpack://ecrf_frontend/./node_modules/core-js/internals/get-iterator-flattenable.js"],"sourcesContent":["'use strict';\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar getIteratorDirect = require('../internals/get-iterator-direct');\nvar getIteratorFlattenable = require('../internals/get-iterator-flattenable');\nvar createIteratorProxy = require('../internals/iterator-create-proxy');\nvar iteratorClose = require('../internals/iterator-close');\nvar IS_PURE = require('../internals/is-pure');\nvar iteratorHelperThrowsOnInvalidIterator = require('../internals/iterator-helper-throws-on-invalid-iterator');\nvar iteratorHelperWithoutClosingOnEarlyError = require('../internals/iterator-helper-without-closing-on-early-error');\n\nvar FLAT_MAP_WITHOUT_THROWING_ON_INVALID_ITERATOR = !IS_PURE\n  && !iteratorHelperThrowsOnInvalidIterator('flatMap', function () { /* empty */ });\nvar flatMapWithoutClosingOnEarlyError = !IS_PURE && !FLAT_MAP_WITHOUT_THROWING_ON_INVALID_ITERATOR\n  && iteratorHelperWithoutClosingOnEarlyError('flatMap', TypeError);\n\nvar FORCED = IS_PURE || FLAT_MAP_WITHOUT_THROWING_ON_INVALID_ITERATOR || flatMapWithoutClosingOnEarlyError;\n\nvar IteratorProxy = createIteratorProxy(function () {\n  var iterator = this.iterator;\n  var mapper = this.mapper;\n  var result, inner;\n\n  while (true) {\n    if (inner = this.inner) try {\n      result = anObject(call(inner.next, inner.iterator));\n      if (!result.done) return result.value;\n      this.inner = null;\n    } catch (error) { iteratorClose(iterator, 'throw', error); }\n\n    result = anObject(call(this.next, iterator));\n\n    if (this.done = !!result.done) return;\n\n    try {\n      this.inner = getIteratorFlattenable(mapper(result.value, this.counter++), false);\n    } catch (error) { iteratorClose(iterator, 'throw', error); }\n  }\n});\n\n// `Iterator.prototype.flatMap` method\n// https://tc39.es/ecma262/#sec-iterator.prototype.flatmap\n$({ target: 'Iterator', proto: true, real: true, forced: FORCED }, {\n  flatMap: function flatMap(mapper) {\n    anObject(this);\n    try {\n      aCallable(mapper);\n    } catch (error) {\n      iteratorClose(this, 'throw', error);\n    }\n\n    if (flatMapWithoutClosingOnEarlyError) return call(flatMapWithoutClosingOnEarlyError, this, mapper);\n\n    return new IteratorProxy(getIteratorDirect(this), {\n      mapper: mapper,\n      inner: null\n    });\n  }\n});\n","/* eslint-disable */\n<template>\n  <div class=\"study-dashboard-container\" v-if=\"study\">\n    <!-- header controls -->\n    <div class=\"dashboard-header-controls\">\n      <button class=\"btn-minimal\" @click=\"goBack\">\n        Back\n      </button>\n      <h2 class=\"dashboard-title\">{{ study.metadata.study_name }}</h2>\n\n      <div class=\"version-dropdown\">\n        <label for=\"version-select\">Version:</label>\n        <select id=\"version-select\" v-model.number=\"selectedVersion\">\n          <option v-for=\"v in studyVersions\" :key=\"'ver-'+v.version\" :value=\"v.version\">\n            {{ v.version }}\n          </option>\n        </select>\n      </div>\n\n      <div class=\"legend-dropdown\">\n        <button class=\"btn-minimal icon-only\" @click=\"showLegend = !showLegend\" title=\"Table Legend\">\n          <i :class=\"icons.info\"></i>\n        </button>\n        <div v-if=\"showLegend\" class=\"legend-content\" @click.stop>\n          <p>\n            <span class=\"legend-swatch swatch-gray\"></span>\n            <strong>Gray cell:</strong> No section assigned for this subject’s group at this visit.\n          </p>\n          <p>\n            <span class=\"legend-swatch swatch-none\"></span>\n            <strong>No color:</strong> Section assigned but no data has been entered.\n          </p>\n          <p>\n            <span class=\"legend-swatch swatch-red\"></span>\n            <strong>Red cell:</strong> Required field was <em>skipped</em> when saving.\n          </p>\n          <p>Data is displayed for each subject under the visit and section assigned to their group.</p>\n        </div>\n      </div>\n\n      <div class=\"export-dropdown\">\n        <button class=\"btn-minimal\" @click.stop=\"toggleExportMenu\">\n          Export <i :class=\"icons.export\"></i>\n        </button>\n        <div v-if=\"showExportMenu\" class=\"export-menu\" @click.stop>\n          <button @click=\"exportCSV\">Download CSV</button>\n          <button @click=\"exportExcel\">Download Excel</button>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"table-controls\">\n      <div class=\"left\">\n        <span>Total rows: {{ totalGridRows }}</span>\n        <label v-if=\"canViewAll\" class=\"view-all\">\n          <input type=\"checkbox\" v-model=\"viewAll\" />\n          View all (≤ {{ VIEW_ALL_MAX_ROWS }})\n        </label>\n      </div>\n      <div class=\"right\" v-if=\"!viewAll\">\n        <label for=\"page-size\">Rows per page:</label>\n        <select id=\"page-size\" v-model.number=\"pageSize\">\n          <option :value=\"50\">50</option>\n          <option :value=\"100\">100</option>\n        </select>\n      </div>\n    </div>\n\n    <div class=\"table-wrapper\">\n      <div class=\"loading\" v-if=\"isLoadingEntries\">Building dashboard…</div>\n\n      <table class=\"dashboard-table\" v-else>\n        <thead>\n          <tr>\n            <th rowspan=\"2\" @click=\"sortTable('subjectId')\">\n              Subject ID\n              <i :class=\"sortIcon('subjectId')\"></i>\n            </th>\n            <th rowspan=\"2\" @click=\"sortTable('visit')\">\n              Visit\n              <i :class=\"sortIcon('visit')\"></i>\n            </th>\n            <template v-for=\"(section, sIdx) in sections\" :key=\"'hdr-sec-'+sIdx\">\n              <th :colspan=\"fieldsPerSection[sIdx]\">{{ section.title }}</th>\n            </template>\n          </tr>\n          <tr>\n            <template v-for=\"(section, sIdx) in sections\" :key=\"'hdr-fld-'+sIdx\">\n              <template v-for=\"(field, fIdx) in section.fields\" :key=\"'hdr-fld-'+sIdx+'-'+fIdx\">\n                <th @click=\"sortTable(`s${sIdx}_f${fIdx}`)\">\n                  {{ field.label || field.name || field.title || `Field ${fIdx+1}` }}\n                  <i :class=\"sortIcon(`s${sIdx}_f${fIdx}`)\"></i>\n                </th>\n              </template>\n            </template>\n          </tr>\n          <tr class=\"filter-row\">\n            <th><input v-model=\"filters.subjectId\" placeholder=\"Filter Subject ID\"></th>\n            <th><input v-model=\"filters.visit\" placeholder=\"Filter Visit\"></th>\n            <template v-for=\"(section, sIdx) in sections\" :key=\"'filter-sec-'+sIdx\">\n              <template v-for=\"(field, fIdx) in section.fields\" :key=\"'filter-fld-'+sIdx+'-'+fIdx\">\n                <th><input v-model=\"filters[`s${sIdx}_f${fIdx}`]\" :placeholder=\"`Filter ${field.label || field.name || field.title || (fIdx+1)}`\"></th>\n              </template>\n            </template>\n          </tr>\n        </thead>\n        <tbody>\n          <template v-for=\"(row, rowIdx) in paginatedData\" :key=\"'row-'+rowIdx\">\n            <tr>\n              <td>{{ row.subjectId }}</td>\n              <td>{{ row.visit }}</td>\n              <template v-for=\"(section, sIdx) in sections\" :key=\"'row-sec-'+rowIdx+'-s'+sIdx\">\n                <template v-for=\"(field, fIdx) in section.fields\" :key=\"'cell-'+rowIdx+'-s'+sIdx+'-f'+fIdx\">\n                  <td :class=\"cellClass(row.__sIdx, row.__vIdx, sIdx, fIdx)\">\n                    {{ row[`s${sIdx}_f${fIdx}`] }}\n                  </td>\n                </template>\n              </template>\n            </tr>\n          </template>\n        </tbody>\n      </table>\n\n      <div class=\"pagination-controls\" v-if=\"!viewAll && !isLoadingEntries\">\n        <button :disabled=\"currentPage === 1\" @click=\"goFirst\">First</button>\n        <button :disabled=\"currentPage === 1\" @click=\"goPrev\">Previous</button>\n        <span>Page {{ currentPage }} of {{ totalPages }}</span>\n        <button :disabled=\"currentPage === totalPages\" @click=\"goNext\">Next</button>\n        <button :disabled=\"currentPage === totalPages\" @click=\"goLast\">Last</button>\n      </div>\n    </div>\n\n    <div v-if=\"!filteredData.length && !isLoadingEntries\" class=\"no-data\">\n      No data entries found. Please enter data for the assigned sections using the data entry form.\n    </div>\n  </div>\n\n  <div v-else class=\"loading\">\n    Loading study data…\n  </div>\n</template>\n\n<script>\nimport axios from 'axios';\nimport icons from \"@/assets/styles/icons\"; // eslint-disable-line no-unused-vars\n\nexport default {\n  name: 'StudyDataDashboard',\n  data() {\n    return {\n      study: null,\n\n      // entries for the current page (or all if viewAll)\n      entries: [],\n      totalEntries: 0, // informational\n\n      showExportMenu: false,\n      showLegend: false,\n      token: this.$store.state.token,\n      icons,\n\n      sortConfig: { key: 'subjectId', direction: 'asc' },\n      filters: { subjectId: '', visit: '' },\n\n      // paging\n      currentPage: 1,\n      pageSize: 50,\n      VIEW_ALL_MAX_ROWS: 1000,\n      viewAll: false,\n      isLoadingEntries: false,\n\n      // versioning\n      studyVersions: [],\n      selectedVersion: null,\n      templateCache: new Map(),\n\n      // debug (no leading underscores to satisfy vue/no-reserved-keys)\n      debugOnce: { study:false, fetch:false, entryShape:false },\n    };\n  },\n  computed: {\n    visits() {\n      return this.study?.content?.study_data?.visits || [];\n    },\n    sections() {\n      return this.study?.content?.study_data?.selectedModels || [];\n    },\n    subjects() {\n      return this.study?.content?.study_data?.subjects || [];\n    },\n    fieldsPerSection() {\n      return this.sections.map(sec => sec.fields?.length || 0);\n    },\n\n    totalGridRows() {\n      return (this.subjects?.length || 0) * (this.visits?.length || 0);\n    },\n    canViewAll() {\n      return this.totalGridRows > 0 && this.totalGridRows <= this.VIEW_ALL_MAX_ROWS;\n    },\n\n    filteredData() {\n      let data = [];\n      const { subjectIdxPageSet, visitIdxPageSet } = this.currentWindowIndexSets();\n\n      this.subjects.forEach((subject, subjIdx) => {\n        if (!subjectIdxPageSet.has(subjIdx)) return;\n\n        const groupIdx = this.resolveGroup(subjIdx);\n        this.visits.forEach((visit, vIdx) => {\n          if (!visitIdxPageSet.has(vIdx)) return;\n\n          const row = { subjectId: subject.id, visit: visit.name, __sIdx: subjIdx, __vIdx: vIdx };\n          this.sections.forEach((section, sIdx) => {\n            const assigned = this.isAssigned(sIdx, vIdx, groupIdx);\n            section.fields.forEach((field, fIdx) => {\n              let value = '';\n              if (assigned) {\n                const raw = this.getValue(subjIdx, vIdx, sIdx, fIdx);\n                const type = (field.type || '').toLowerCase();\n                if (type === 'checkbox') {\n                  value = (raw === true) ? 'Yes'\n                        : (raw === false) ? 'No'\n                        : '';\n                } else if (type === 'file') {\n                  value = this.formatFileCell(raw);\n                } else {\n                  value = (raw == null || raw === '') ? '' : raw;\n                }\n              }\n              row[`s${sIdx}_f${fIdx}`] = value;\n            });\n          });\n          data.push(row);\n        });\n      });\n\n      // Column filters\n      data = data.filter(row => {\n        if (this.filters.subjectId && !String(row.subjectId).toLowerCase().includes(this.filters.subjectId.toLowerCase())) return false;\n        if (this.filters.visit && !String(row.visit).toLowerCase().includes(this.filters.visit.toLowerCase())) return false;\n\n        for (const key in this.filters) {\n          if (key === 'subjectId' || key === 'visit') continue;\n          const filterVal = this.filters[key];\n          if (filterVal && !String(row[key] ?? '').toLowerCase().includes(String(filterVal).toLowerCase())) {\n            return false;\n          }\n        }\n        return true;\n      });\n\n      // Sorting\n      if (this.sortConfig.key) {\n        const key = this.sortConfig.key;\n        const dir = this.sortConfig.direction === 'asc' ? 1 : -1;\n        data.sort((a, b) => {\n          let valA = a[key] ?? '';\n          let valB = b[key] ?? '';\n          valA = String(valA).toLowerCase();\n          valB = String(valB).toLowerCase();\n          if (valA < valB) return -1 * dir;\n          if (valA > valB) return 1 * dir;\n          return 0;\n        });\n      }\n\n      return data;\n    },\n\n    totalPages() {\n      if (this.viewAll) return 1;\n      const wholeGridPages = Math.ceil(this.totalGridRows / this.pageSize);\n      return Math.max(1, wholeGridPages);\n    },\n\n    paginatedData() {\n      return this.filteredData;\n    },\n  },\n  watch: {\n    pageSize() {\n      if (this.viewAll) return;\n      this.currentPage = 1;\n      this.fetchPageEntries();\n    },\n    currentPage() {\n      if (this.viewAll) return;\n      this.fetchPageEntries();\n    },\n    viewAll() {\n      this.currentPage = 1;\n      this.fetchPageEntries();\n    },\n    filters: {\n      handler() {\n        if (!this.viewAll) this.fetchPageEntries();\n      },\n      deep: true,\n    },\n    selectedVersion: {\n      async handler() {\n        if (!this.study) return;\n        await this.loadTemplateForSelectedVersion();\n        this.initDynamicFilters();\n        this.currentPage = 1;\n        await this.fetchPageEntries();\n      }\n    }\n  },\n  async created() {\n    await this.bootstrap();\n  },\n  methods: {\n    // ---- debug helpers ----\n    dbg(...args){ console.log('[Dashboard]', ...args); },\n    groupDbg(label, obj){ console.groupCollapsed('[Dashboard]', label); console.log(obj); console.groupEnd(); },\n    normalizeKey(k){ return String(k || '').trim().toLowerCase(); },\n    listKeys(obj){ return Object.keys(obj || {}); },\n\n    // ---- dict helpers (section/field keys consistent with save) ----\n    sectionDictKey(sectionObj) {\n      return sectionObj?.title ?? '';\n    },\n    fieldDictKey(fieldObj, fallbackIndex) {\n      // include 'id' fallback\n      return fieldObj?.name ?? fieldObj?.key ?? fieldObj?.id ?? fieldObj?.label ?? fieldObj?.title ?? `f${fallbackIndex}`;\n    },\n    // tolerant getter: exact match, else case/trim-insensitive fallback (logs on miss)\n    dictRead(dataDict, sIdx, fIdx) {\n      if (!dataDict || typeof dataDict !== 'object' || Array.isArray(dataDict)) return undefined;\n\n      const sec = this.sections[sIdx];\n      const fld = sec?.fields?.[fIdx];\n\n      const sKey = this.sectionDictKey(sec);\n      const fKey = this.fieldDictKey(fld, fIdx);\n\n      let secObj = dataDict[sKey];\n      // fallback section key (case/trim-insensitive)\n      if (!secObj) {\n        const wanted = this.normalizeKey(sKey);\n        const hitKey = Object.keys(dataDict).find(k => this.normalizeKey(k) === wanted);\n        if (hitKey) {\n          secObj = dataDict[hitKey];\n          this.dbg('Section key fallback used:', { expected: sKey, matched: hitKey });\n        }\n      }\n      if (!secObj || typeof secObj !== 'object') {\n        this.dbg('dictRead: section not found', { sIdx, sKey, available: this.listKeys(dataDict) });\n        return undefined;\n      }\n\n      if (Object.prototype.hasOwnProperty.call(secObj, fKey)) return secObj[fKey];\n\n      // fallback field key (case/trim-insensitive)\n      const wantedField = this.normalizeKey(fKey);\n      const hitField = Object.keys(secObj).find(k => this.normalizeKey(k) === wantedField);\n      if (hitField) {\n        this.dbg('Field key fallback used:', { sKey, expectedField: fKey, matchedField: hitField });\n        return secObj[hitField];\n      }\n\n      this.dbg('dictRead: field not found', {\n        sIdx, fIdx, sKey, fKey,\n        availableFields: this.listKeys(secObj)\n      });\n      return undefined;\n    },\n\n    async bootstrap() {\n      const studyId = this.$route.params.id;\n      try {\n        const studyResp = await axios.get(`/forms/studies/${studyId}`, {\n          headers: { Authorization: `Bearer ${this.token}` },\n        });\n        this.study = studyResp.data;\n\n        await this.loadVersions(studyId);\n        if (!this.selectedVersion && this.studyVersions.length) {\n          this.selectedVersion = this.studyVersions[this.studyVersions.length - 1].version;\n        }\n        await this.loadTemplateForSelectedVersion();\n\n        if (!this.debugOnce.study) {\n          this.debugOnce.study = true;\n          this.groupDbg('Study loaded', {\n            studyId,\n            subjects: this.subjects.length,\n            visits: this.visits.length,\n            sections: this.sections.map((s, i) => ({\n              i, title: s.title,\n              fieldKeys: (s.fields || []).map((f, j) => this.fieldDictKey(f, j))\n            })),\n            assignmentsShape: {\n              m: this.sections.length,\n              v: this.visits.length,\n              g: (this.study?.content?.study_data?.groups || []).length\n            }\n          });\n        }\n\n        this.initDynamicFilters();\n\n        if (this.canViewAll) this.viewAll = false;\n        await this.fetchPageEntries();\n      } catch (err) {\n        console.error('Failed to load dashboard data:', err);\n        if (err.response && err.response.status === 401) {\n          this.$router.push({ name: 'Login' });\n        } else {\n          alert('Could not load study data');\n        }\n      }\n    },\n\n    initDynamicFilters() {\n      const base = { subjectId: this.filters.subjectId || '', visit: this.filters.visit || '' };\n      const next = { ...base };\n      this.sections.forEach((section, sIdx) => {\n        section.fields.forEach((_, fIdx) => {\n          const key = `s${sIdx}_f${fIdx}`;\n          next[key] = this.filters[key] || '';\n        });\n      });\n      this.filters = next;\n    },\n\n    async loadVersions(studyId) {\n      try {\n        const resp = await axios.get(`/forms/studies/${studyId}/versions`, {\n          headers: { Authorization: `Bearer ${this.token}` }\n        });\n        const arr = Array.isArray(resp.data) ? resp.data : [];\n        this.studyVersions = arr.sort((a, b) => a.version - b.version);\n      } catch (e) {\n        this.studyVersions = [{ version: 1 }];\n      }\n    },\n\n    async loadTemplateForSelectedVersion() {\n      const studyId = this.$route.params.id;\n      if (!studyId || !this.selectedVersion) return;\n\n      if (this.templateCache.has(this.selectedVersion)) {\n        const cached = this.templateCache.get(this.selectedVersion);\n        this.applyTemplateSchema(cached);\n        return;\n      }\n      try {\n        const resp = await axios.get(`/forms/studies/${studyId}/template`, {\n          headers: { Authorization: `Bearer ${this.token}` },\n          params: { version: this.selectedVersion }\n        });\n        const schema = resp?.data?.schema || {};\n        this.templateCache.set(this.selectedVersion, schema);\n        this.applyTemplateSchema(schema);\n      } catch (e) {\n        // keep existing template if fetch fails\n      }\n    },\n\n    applyTemplateSchema(schema) {\n      const current = this.study?.content?.study_data || {};\n      const normalized = {\n        study: schema?.study ?? current.study ?? {},\n        subjects: Array.isArray(schema?.subjects) && schema.subjects.length ? schema.subjects : (current.subjects || []),\n        subjectCount: Number.isFinite(schema?.subjectCount) ? schema.subjectCount : (current.subjectCount ?? (current.subjects?.length || 0)),\n        visits: Array.isArray(schema?.visits) && schema.visits.length ? schema.visits : (current.visits || []),\n        groups: Array.isArray(schema?.groups) && schema.groups.length ? schema.groups : (current.groups || []),\n        selectedModels: Array.isArray(schema?.selectedModels) ? schema.selectedModels : (current.selectedModels || []),\n        assignments: Array.isArray(schema?.assignments) ? schema.assignments : (current.assignments || []),\n      };\n      if (!this.study) this.study = { metadata: {}, content: { study_data: normalized } };\n      else if (!this.study.content) this.study.content = { study_data: normalized };\n      else this.study.content.study_data = normalized;\n    },\n\n    currentWindowIndexSets() {\n      const S = this.subjects.length;\n      const V = this.visits.length;\n\n      if (this.viewAll || S === 0 || V === 0) {\n        return {\n          subjectIdxPageSet: new Set([...Array(S).keys()]),\n          visitIdxPageSet: new Set([...Array(V).keys()]),\n          totalRowsInWindow: S * V,\n        };\n      }\n\n      const pageStart = (this.currentPage - 1) * this.pageSize;\n      const pageEndExcl = Math.min(pageStart + this.pageSize, S * V);\n\n      const subjSet = new Set();\n      const visitSet = new Set();\n\n      for (let idx = pageStart; idx < pageEndExcl; idx++) {\n        const subjIdx = Math.floor(idx / V);\n        const visitIdx = idx % V;\n        subjSet.add(subjIdx);\n        visitSet.add(visitIdx);\n      }\n\n      return {\n        subjectIdxPageSet: subjSet,\n        visitIdxPageSet: visitSet,\n        totalRowsInWindow: pageEndExcl - pageStart,\n      };\n    },\n\n    async fetchPageEntries() {\n      if (!this.study) return;\n      const studyId = this.$route.params.id;\n\n      const { subjectIdxPageSet, visitIdxPageSet } = this.currentWindowIndexSets();\n\n      const subject_indexes = this.viewAll\n        ? null\n        : Array.from(subjectIdxPageSet).sort((a, b) => a - b).join(',');\n      const visit_indexes = this.viewAll\n        ? null\n        : Array.from(visitIdxPageSet).sort((a, b) => a - b).join(',');\n\n      const params = new URLSearchParams();\n      if (this.viewAll) params.append('all', 'true');\n      if (subject_indexes) params.append('subject_indexes', subject_indexes);\n      if (visit_indexes) params.append('visit_indexes', visit_indexes);\n      if (Number.isFinite(this.selectedVersion)) params.append('version', String(this.selectedVersion));\n\n      const url = `/forms/studies/${studyId}/data_entries` + (params.toString() ? `?${params.toString()}` : '');\n\n      try {\n        this.isLoadingEntries = true;\n        if (!this.debugOnce.fetch) {\n          this.debugOnce.fetch = true;\n          this.dbg('Fetching entries…', { url, viewAll: this.viewAll, subject_indexes, visit_indexes, version: this.selectedVersion });\n        }\n        const resp = await axios.get(url, { headers: { Authorization: `Bearer ${this.token}` } });\n        const payload = Array.isArray(resp.data) ? { entries: resp.data, total: resp.data.length } : (resp.data || {});\n        this.entries = payload.entries || [];\n        this.totalEntries = payload.total ?? this.entries.length;\n\n        if (!this.debugOnce.entryShape) {\n          this.debugOnce.entryShape = true;\n          const sample = (this.entries || []).slice(0, 3).map(e => ({\n            id: e.id,\n            s: e.subject_index, v: e.visit_index, g: e.group_index,\n            dataType: Array.isArray(e.data) ? 'array' : (e.data && typeof e.data === 'object') ? 'dict' : typeof e.data,\n            topKeys: e.data && typeof e.data === 'object' && !Array.isArray(e.data) ? Object.keys(e.data) : null\n          }));\n          this.groupDbg('Entries fetched', {\n            count: this.entries.length,\n            sample\n          });\n          if (sample[0]?.topKeys) {\n            this.dbg('First entry dict section keys:', sample[0].topKeys);\n          }\n        }\n\n      } catch (err) {\n        console.error('Failed to load entries:', err);\n        this.entries = [];\n      } finally {\n        this.isLoadingEntries = false;\n      }\n    },\n\n    goBack() {\n      const id = this.$route.params.id;\n      this.$router.push({ name: \"StudyView\", params: { id } });\n    },\n    toggleExportMenu() {\n      this.showExportMenu = !this.showExportMenu;\n    },\n\n    // --- helpers to resolve & read data ---\n    resolveGroup(subjIdx) {\n      const subjGroup = (this.subjects[subjIdx]?.group || '').trim().toLowerCase();\n      const grpList = this.study?.content?.study_data?.groups || [];\n      const idx = grpList.findIndex(g => (g.name || '').trim().toLowerCase() === subjGroup);\n      if (idx < 0) {\n        this.dbg('resolveGroup: subject group not found, defaulting to 0', {\n          subjectIndex: subjIdx, subjectGroup: subjGroup, availableGroups: grpList.map(g => g.name)\n        });\n      }\n      return idx >= 0 ? idx : 0;\n    },\n    isAssigned(sectionIdx, visitIdx, groupIdx) {\n      const ok = !!(this.study?.content?.study_data?.assignments?.[sectionIdx]?.[visitIdx]?.[groupIdx]);\n      if (!ok && (sectionIdx === 0) && (visitIdx === 0) && (groupIdx === 0)) {\n        this.dbg('isAssigned=false example', { sectionIdx, visitIdx, groupIdx });\n      }\n      return ok;\n    },\n    findBestEntry(subjIdx, visitIdx, groupIdx) {\n      const all = (this.entries || []).filter(e =>\n        e.subject_index === subjIdx &&\n        e.visit_index === visitIdx &&\n        e.group_index === groupIdx\n      );\n      if (!all.length) return null;\n\n      const target = Number(this.selectedVersion);\n      // Prefer exact match\n      const exact = all.find(e => Number(e.form_version) === target);\n      if (exact) return exact;\n\n      // Else highest version <= target\n      const le = all\n        .filter(e => Number(e.form_version) <= target)\n        .sort((a, b) => Number(b.form_version) - Number(a.form_version))[0];\n      if (le) return le;\n\n      // Fallback: highest version available\n      return all.sort((a, b) => Number(b.form_version) - Number(a.form_version))[0];\n    },\n\n    getValue(subjIdx, visitIdx, sectionIdx, fieldIdx) {\n      const groupIdx = this.resolveGroup(subjIdx);\n      const entry = this.findBestEntry(subjIdx, visitIdx, groupIdx);\n      if (!entry || !entry.data) return '';\n      const d = entry.data;\n      if (!Array.isArray(d)) {\n        const v = this.dictRead(d, sectionIdx, fieldIdx);\n        return v != null ? v : '';\n      }\n      const section = Array.isArray(d) ? (d[sectionIdx] || []) : [];\n      return section[fieldIdx] != null ? section[fieldIdx] : '';\n    },\n    isCellSkipped(subjIdx, visitIdx, sectionIdx, fieldIdx) {\n      const groupIdx = this.resolveGroup(subjIdx);\n      const entry = this.findBestEntry(subjIdx, visitIdx, groupIdx);\n      if (!entry) return false;\n      const flags = entry.skipped_required_flags;\n      return !!(Array.isArray(flags) &&\n                Array.isArray(flags[sectionIdx]) &&\n                flags[sectionIdx][fieldIdx] === true);\n    },\n    cellClass(subjIdx, visitIdx, sectionIdx, fieldIdx) {\n      const groupIdx = this.resolveGroup(subjIdx);\n      const assigned = this.isAssigned(sectionIdx, visitIdx, groupIdx);\n      const raw = assigned ? this.getValue(subjIdx, visitIdx, sectionIdx, fieldIdx) : '';\n      const field = this.sections?.[sectionIdx]?.fields?.[fieldIdx] || {};\n      const isCheckbox = (field.type || '').toLowerCase() === 'checkbox';\n      const hasData = isCheckbox ? (raw === true || raw === false) : !(raw == null || raw === '');\n\n      return {\n        'cell-skipped': this.isCellSkipped(subjIdx, visitIdx, sectionIdx, fieldIdx),\n        'cell-unassigned': !assigned,\n        'cell-empty-assigned': false && assigned && !hasData\n      };\n    },\n\n    // Sorting\n    sortTable(key) {\n      if (this.sortConfig.key === key) {\n        this.sortConfig.direction = this.sortConfig.direction === 'asc' ? 'desc' : 'asc';\n      } else {\n        this.sortConfig = { key, direction: 'asc' };\n      }\n    },\n    sortIcon(key) {\n      return this.sortConfig.key === key && this.sortConfig.direction === 'desc'\n        ? this.icons.toggleDown\n        : this.icons.toggleUp;\n    },\n\n    // file cell formatter\n    formatFileCell(val) {\n      const baseName = (p) => {\n        if (!p) return '';\n        const s = String(p);\n        const parts = s.split(/[\\\\/]/);\n        return parts[parts.length - 1];\n      };\n      const fromObj = (o) => o.file_name || o.name || baseName(o.url) || baseName(o.file_path) || '';\n      if (Array.isArray(val)) {\n        const names = val.map(v => {\n          if (v && typeof v === 'object') return fromObj(v);\n          if (typeof v === 'string') return baseName(v);\n          return '';\n        }).filter(Boolean);\n        return names.join(', ');\n      }\n      if (val && typeof val === 'object') {\n        return fromObj(val);\n      }\n      if (typeof val === 'string') {\n        return baseName(val);\n      }\n      return '';\n    },\n\n    // Paging helpers\n    goFirst() { this.currentPage = 1; }\n    ,\n    goPrev()  { if (this.currentPage > 1) this.currentPage--; }\n    ,\n    goNext()  { if (this.currentPage < this.totalPages) this.currentPage++; }\n    ,\n    goLast()  { this.currentPage = this.totalPages; }\n    ,\n\n    // Exports\n    async exportCSV() {\n      const allRows = await this.ensureAllEntriesForExport();\n      this.downloadDelimited(allRows, 'csv');\n      this.showExportMenu = false;\n    },\n    async exportExcel() {\n      const allRows = await this.ensureAllEntriesForExport();\n      this.downloadDelimited(allRows, 'xls');\n      this.showExportMenu = false;\n    },\n    async ensureAllEntriesForExport() {\n      const studyId = this.$route.params.id;\n\n      let entriesForExport = this.entries;\n\n      if (!this.viewAll && !this.canViewAll) {\n        try {\n          const resp = await axios.get(\n            `/forms/studies/${studyId}/data_entries?all=true&version=${this.selectedVersion}`,\n            { headers: { Authorization: `Bearer ${this.token}` } }\n          );\n          const payload = Array.isArray(resp.data) ? { entries: resp.data } : (resp.data || {});\n          entriesForExport = payload.entries || [];\n        } catch (e) {\n          console.error('Failed to fetch all entries for export, using current page only.', e);\n        }\n      }\n\n      const original = this.entries;\n      this.entries = entriesForExport;\n\n      const rows = [];\n      this.subjects.forEach((subject, subjIdx) => {\n        const groupIdx = this.resolveGroup(subjIdx);\n        this.visits.forEach((visit, vIdx) => {\n          const row = { subjectId: subject.id, visit: visit.name };\n          this.sections.forEach((section, sIdx) => {\n            const assigned = this.isAssigned(sIdx, vIdx, groupIdx);\n            section.fields.forEach((field, fIdx) => {\n              let value = '';\n              if (assigned) {\n                const raw = this.getValue(subjIdx, vIdx, sIdx, fIdx);\n                const type = (field.type || '').toLowerCase();\n                if (type === 'checkbox') {\n                  value = (raw === true) ? 'Yes'\n                        : (raw === false) ? 'No'\n                        : '';\n                } else if (type === 'file') {\n                  value = this.formatFileCell(raw);\n                } else {\n                  value = (raw == null || raw === '') ? '' : raw;\n                }\n              }\n              row[`s${sIdx}_f${fIdx}`] = value;\n            });\n          });\n          rows.push(row);\n        });\n      });\n\n      this.entries = original;\n      return rows;\n    },\n    downloadDelimited(rows, kind) {\n      const quote = v => `\"${String(v).replace(/\"/g, '\"\"')}\"`;\n      const hdr1 = ['Subject ID', 'Visit', ...this.sections.flatMap((s, i) => Array(this.fieldsPerSection[i]).fill(s.title))];\n      const hdr2 = ['', '', ...this.sections.flatMap(sec => sec.fields.map(f => f.label || f.name || f.title))];\n\n      const lines = [];\n      lines.push(hdr1.map(quote).join(','));\n      lines.push(hdr2.map(quote).join(','));\n\n      // Apply current filters to exported rows as well\n      const filteredRows = rows.filter(row => {\n        if (this.filters.subjectId && !String(row.subjectId).toLowerCase().includes(this.filters.subjectId.toLowerCase())) return false;\n        if (this.filters.visit && !String(row.visit).toLowerCase().includes(this.filters.visit.toLowerCase())) return false;\n        for (const key in this.filters) {\n          if (key === 'subjectId' || key === 'visit') continue;\n          const f = this.filters[key];\n          if (f && !String(row[key] ?? '').toLowerCase().includes(String(f).toLowerCase())) return false;\n        }\n        return true;\n      });\n\n      filteredRows.forEach(row => {\n        const cells = [row.subjectId, row.visit];\n        this.sections.forEach((section, sIdx) => {\n          section.fields.forEach((_, fIdx) => {\n            cells.push(row[`s${sIdx}_f${fIdx}`]);\n          });\n        });\n        lines.push(cells.map(quote).join(','));\n      });\n\n      const mime = kind === 'xls'\n        ? 'application/vnd.ms-excel'\n        : 'text/csv';\n      const ext = kind === 'xls' ? 'xls' : 'csv';\n\n      const blob = new Blob([lines.join('\\r\\n')], { type: mime });\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `${this.study?.metadata?.study_name || 'study'}_v${this.selectedVersion}_data.${ext}`;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      URL.revokeObjectURL(url);\n    },\n  },\n};\n</script>\n\n<style scoped>\n/* (unchanged styles from your file) */\n.dashboard-header-controls {\n  display: grid;\n  grid-template-columns: auto 1fr auto auto auto;\n  align-items: center;\n  gap: 12px;\n  margin-bottom: 12px;\n}\n.dashboard-header-controls .btn-minimal { justify-self: start; }\n.dashboard-header-controls .export-dropdown,\n.dashboard-header-controls .legend-dropdown,\n.dashboard-header-controls .version-dropdown {\n  justify-self: end;\n  position: relative;\n}\n.dashboard-title {\n  justify-self: center;\n  margin: 0;\n  font-size: 1.5rem;\n  font-weight: 600;\n  color: #333;\n}\n.btn-minimal {\n  background: transparent;\n  border: 1px solid #d1d5db;\n  border-radius: 4px;\n  padding: 6px 12px;\n  font-size: 0.9rem;\n  color: #374151;\n  cursor: pointer;\n  transition: background 0.15s, color 0.15s, border-color 0.15s;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n}\n.btn-minimal:hover { background: #f3f4f6; border-color: #9ca3af; color: #1f2937; }\n.icon-only { padding: 6px; font-size: 1rem; }\n\n.version-dropdown label {\n  margin-right: 6px;\n  font-size: 0.9rem;\n  color: #374151;\n}\n.version-dropdown select {\n  padding: 6px 10px;\n  border: 1px solid #d1d5db;\n  border-radius: 4px;\n  background: #fff;\n  font-size: 0.9rem;\n  color: #374151;\n}\n\n.export-menu,\n.legend-content {\n  position: absolute;\n  top: 100%;\n  right: 0;\n  background: white;\n  border: 1px solid #d1d5db;\n  border-radius: 4px;\n  box-shadow: 0 2px 6px rgba(0,0,0,0.1);\n  z-index: 20;\n  padding: 12px;\n  min-width: 240px;\n}\n.export-menu button {\n  display: block; width: 100%; padding: 8px 16px; background: none; border: none;\n  text-align: left; font-size: 0.9rem; cursor: pointer;\n}\n.export-menu button:hover { background: #f3f4f6; }\n\n.legend-swatch {\n  display: inline-block;\n  width: 14px;\n  height: 14px;\n  margin-right: 6px;\n  border: 1px solid #d1d5db;\n  vertical-align: -2px;\n  background: #ffffff;\n}\n\n/* legend variants */\n.swatch-none { background: #ffffff; border-color: #d1d5db; }\n.swatch-gray { background: #e5e7eb; border-color: #9ca3af; }\n.swatch-red  { background: #fee2e2; border-color: #ef4444; }\n\n/* table */\n.table-controls {\n  display: flex; justify-content: space-between; align-items: center; margin: 8px 0;\n  color: #4b5563; font-size: 0.9rem;\n}\n.table-controls .view-all { margin-left: 12px; }\n\n.table-wrapper { overflow-x: auto; width: 100%; max-width: 100%; }\n\n.dashboard-table { width: 100%; border-collapse: collapse; margin-top: 8px; }\n.dashboard-table th, .dashboard-table td {\n  border: 1px solid #e5e7eb; padding: 8px 12px; font-size: 0.9rem; text-align: center;\n}\n.dashboard-table th { cursor: pointer; white-space: nowrap; }\n.dashboard-table th i { font-size: 0.8rem; color: #1f2937; margin-left: 4px; }\n.dashboard-table thead tr:nth-child(1) th { background: #e5e7eb; font-weight: 600; color: #1f2937; }\n.dashboard-table thead tr:nth-child(2) th { background: #f3f4f6; font-weight: 600; color: #374151; }\n\n.dashboard-table tbody td:first-child,\n.dashboard-table tbody td:nth-child(2) {\n  background: #f9fafb; font-weight: 600; color: #1f2937;\n}\n.dashboard-table tbody td:not(:first-child):not(:nth-child(2)) { background: #ffffff; color: #4b5563; }\n.dashboard-table tbody tr:hover td { background: #f1f5f9; }\n\n/* Assigned but empty: now no special color (kept for compatibility, not applied) */\n.cell-empty-assigned {\n  background: #e5e7eb !important;\n  color: #374151;\n  border-color: #d1d5db !important;\n}\n\n/* Unassigned cell (gray) */\n.cell-unassigned {\n  background: #e5e7eb !important;\n  color: #374151;\n  border-color: #d1d5db !important;\n}\n\n/* Skipped cell (red) */\n.cell-skipped {\n  background: #fee2e2 !important;\n  color: #991b1b;\n  border-color: #ef4444 !important;\n  font-weight: 600;\n}\n\n.loading { text-align: center; padding: 24px; color: #6b7280; }\n.no-data { text-align: center; padding: 16px; color: #6b7280; font-style: italic; }\n\n.filter-row input {\n  width: 100%; padding: 4px; box-sizing: border-box;\n  border: 1px solid #d1d5db; border-radius: 4px; font-size: 0.9rem;\n}\n\n.pagination-controls {\n  display: flex; justify-content: center; gap: 8px; margin: 12px 0 0;\n}\n.pagination-controls button {\n  background: #f3f4f6; border: 1px solid #d1d5db; padding: 6px 12px; cursor: pointer; border-radius: 4px;\n}\n.pagination-controls button:disabled { opacity: 0.5; cursor: not-allowed; }\n</style>\n","import { render } from \"./StudyDataDashboard.vue?vue&type=template&id=670e0aad&scoped=true\"\nimport script from \"./StudyDataDashboard.vue?vue&type=script&lang=js\"\nexport * from \"./StudyDataDashboard.vue?vue&type=script&lang=js\"\n\nimport \"./StudyDataDashboard.vue?vue&type=style&index=0&id=670e0aad&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-670e0aad\"]])\n\nexport default __exports__","'use strict';\nvar call = require('../internals/function-call');\nvar anObject = require('../internals/an-object');\nvar getIteratorDirect = require('../internals/get-iterator-direct');\nvar getIteratorMethod = require('../internals/get-iterator-method');\n\nmodule.exports = function (obj, stringHandling) {\n  if (!stringHandling || typeof obj !== 'string') anObject(obj);\n  var method = getIteratorMethod(obj);\n  return getIteratorDirect(anObject(method !== undefined ? call(method, obj) : obj));\n};\n"],"names":["$","call","aCallable","anObject","getIteratorDirect","getIteratorFlattenable","createIteratorProxy","iteratorClose","IS_PURE","iteratorHelperThrowsOnInvalidIterator","iteratorHelperWithoutClosingOnEarlyError","FLAT_MAP_WITHOUT_THROWING_ON_INVALID_ITERATOR","flatMapWithoutClosingOnEarlyError","TypeError","FORCED","IteratorProxy","result","inner","iterator","this","mapper","next","done","value","error","counter","target","proto","real","forced","flatMap","class","$data","study","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","onClick","_cache","args","$options","goBack","_hoisted_3","_toDisplayString","metadata","study_name","_hoisted_4","for","id","selectedVersion","$event","_Fragment","_renderList","studyVersions","v","key","version","_hoisted_5","number","_hoisted_6","showLegend","title","_normalizeClass","icons","info","_withModifiers","_hoisted_7","toggleExportMenu","export","showExportMenu","exportCSV","exportExcel","_hoisted_8","_hoisted_9","totalGridRows","canViewAll","_hoisted_10","type","viewAll","VIEW_ALL_MAX_ROWS","_hoisted_11","pageSize","_hoisted_12","isLoadingEntries","_hoisted_13","_hoisted_14","rowspan","sortTable","sortIcon","sections","section","sIdx","colspan","fieldsPerSection","_hoisted_15","fields","field","fIdx","label","name","_hoisted_17","filters","subjectId","placeholder","visit","paginatedData","row","rowIdx","cellClass","__sIdx","__vIdx","_hoisted_19","disabled","currentPage","goFirst","_hoisted_20","goPrev","_hoisted_21","totalPages","goNext","_hoisted_22","goLast","_hoisted_23","filteredData","length","_hoisted_24","_hoisted_25","data","entries","totalEntries","token","$store","state","sortConfig","direction","templateCache","Map","debugOnce","fetch","entryShape","computed","visits","content","study_data","selectedModels","subjects","map","sec","subjectIdxPageSet","visitIdxPageSet","currentWindowIndexSets","forEach","subject","subjIdx","has","groupIdx","resolveGroup","vIdx","assigned","isAssigned","raw","getValue","toLowerCase","formatFileCell","push","filter","String","includes","filterVal","dir","sort","a","b","valA","valB","wholeGridPages","Math","ceil","max","watch","fetchPageEntries","handler","deep","loadTemplateForSelectedVersion","initDynamicFilters","created","bootstrap","methods","dbg","console","log","groupDbg","obj","groupCollapsed","groupEnd","normalizeKey","k","trim","listKeys","Object","keys","sectionDictKey","sectionObj","fieldDictKey","fieldObj","fallbackIndex","dictRead","dataDict","Array","isArray","fld","sKey","fKey","secObj","wanted","hitKey","find","expected","matched","available","prototype","hasOwnProperty","wantedField","hitField","expectedField","matchedField","availableFields","studyId","$route","params","studyResp","axios","get","headers","Authorization","loadVersions","s","i","fieldKeys","f","j","assignmentsShape","m","g","groups","err","response","status","$router","alert","base","_","resp","arr","e","cached","applyTemplateSchema","schema","set","current","normalized","subjectCount","Number","isFinite","assignments","S","V","Set","totalRowsInWindow","pageStart","pageEndExcl","min","subjSet","visitSet","idx","floor","visitIdx","add","subject_indexes","from","join","visit_indexes","URLSearchParams","append","url","toString","payload","total","sample","slice","subject_index","visit_index","group_index","dataType","topKeys","count","subjGroup","group","grpList","findIndex","subjectIndex","subjectGroup","availableGroups","sectionIdx","ok","findBestEntry","all","exact","form_version","le","fieldIdx","entry","d","isCellSkipped","flags","skipped_required_flags","toggleDown","toggleUp","val","baseName","p","parts","split","fromObj","o","file_name","file_path","names","Boolean","allRows","ensureAllEntriesForExport","downloadDelimited","entriesForExport","original","rows","kind","quote","replace","hdr1","fill","hdr2","lines","filteredRows","cells","mime","ext","blob","Blob","URL","createObjectURL","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","__exports__","render","getIteratorMethod","module","exports","stringHandling","method","undefined"],"sourceRoot":""}